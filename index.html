<html>
<head>
	<link rel="stylesheet" type="text/css" href="corkboard_theme.css"/>
	<link rel="stylesheet" type="text/css" href="task_list.css"/>
	<script type="text/javascript" src="external_js/jquery-1.9.0.min.js"></script>
	<link rel="stylesheet" href="http://code.jquery.com/ui/1.10.2/themes/smoothness/jquery-ui.css" />

	<script type="text/javascript" src="external_js/jquery-ui-1.10.0.custom.min.js"></script>
	<script type="text/javascript" src="js/jquery.blur_default.js"></script>
	<script type="text/javascript" src="external_js/date.js"></script>
	<script type="text/javascript" src="static_js/task.js"></script>

	<script type="text/javascript">

	//wrapper tracing function
	function line(txt){
		console.log(txt);
	}

	function taskClick(elem){			
		var item = $(elem);
		line(item.attr('id'));
	}

	function updateTaskList(task){
		line("--updateTaskList--");
		var template = $("#taskRowTemplate");
		var container = $("#taskContainer");
		var taskDiv = template.clone().attr('id', task.id);			
		taskDiv.appendTo(container);
		var complete = $(taskDiv).find(".taskComplete");
		complete.html("To Do");
		var label = taskDiv.find(".taskLabel");
		label.html(task.name);
		var taskDue = taskDiv.find(".taskDue");		
		taskDue.html(task.due);
	}

	(function($) {
		$(function() {
			// Handle the input field defaults.
			$('.remember').blur_default();

			// Insert weekdays from tomorrow till a week from today.
			var duedd = $('#due');
			var day_start = (2).day().fromNow();
			for (var i = 0; i < 5; ++i) {
				var day_name = day_start.toString('dddd');
				duedd.append('<option value="'+day_name+'">Due: '
					+day_name+'</option>');
				day_start = day_start.add(1).day();
			}

			$('#new_task_btn').click(function() {
				console.log('foo');
				$('#item_entry').show();
				$('#item_entry input[type="text"]').focus();
			});

			$('#add_task').click(function() {
				console.log('bar');
				//$('#item_entry').hide();
			});
			var id = 0;
			var form = $('form#new_task');
			form.submit(function(e) {
				tasks = new Array();
				e.preventDefault();
				var taskTxt = form.find('[name="taskname"]').val();
				var taskDue = form.find('[name="due"]').val();
				var task = new Task(taskTxt, id);
				task.duedate = taskDue;
				++id;
				tasks[id] = task;
				updateTaskList(task);
			});
			
			$('.profile').click(function(evt) {
				console.log(evt.target.id.slice(3));
    			window.location = 'member_history.html?member=' + evt.target.id.slice(3);
    		});
			
	    });
	})(jQuery);
	</script>
	<title>Household Dashboard</title>
</head>
<body>
	<div id="content">
		<div style="position: relative;">
			<img class="pin_left" src="assets/pushpin.png">
			<h1>Household Dashboard</h1>
		</div>
		<div id="navigation">
			<div class="tabs_container">
				<ul id="tabs">
					<li>To-Do</li>
				</ul>
			</div>
			<div class="family_container">
				<ul id="family">
					<li><div class="profile"><img src="assets/Cersei.jpg" id="picCersei"><h3>Cersei</h3></div></li>
					<li><div class="profile"><img src="assets/Robert.jpg" id="picRobert"><h3>Robert</h3></div></li>
					<li><div class="profile"><img src="assets/Joffrey.jpg" id="picJoffrey"><h3>Joffrey</h3></div></li>
					<li><div class="profile"><img src="assets/Myrcella.jpg" id="picMyrcella"><h3>Myrcella</h3></div></li>
					<li><div class="profile"><img src="assets/Tommen.jpg" id="picTommen"><h3>Tommen</h3></div></li>
				</ul>
			</div>
		</div>
		<div id="tasklist">
			
			<div>
				<h2>To-Do</h2>
			</div>
			<div id="item_entry">
				<form id="new_task" target="index.html">
					<!--<button>?</button>-->
					<input class="remember" type="text" name="taskname" value="Enter Task Name">
					<!-- <label for="due">Due</label>-->
					<select name="due" id="due">
						<option value="ASAP">Due: ASAP</option>
						<option value="Today">Due: Today</option>
						<option value="Tomorrow">Due: Tomorrow</option>
						<!-- Javascript will add next 5 days -->
					</select>
					<button id="add_task">Add</button>
				</form>
			</div>
			<div id="taskContainer">
				<div id="taskRowTemplate" class="taskRow" onclick="javascript:taskClick(this)">
					<div class="taskRowInner">
						<div class="taskComplete"></div>
						<div class="taskLabel"></div>
						<div class="taskDue"></div>
					</div>
				</div>
			</div>

		</div>
	</div>
</body>
</html>
